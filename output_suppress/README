This is Genesis version modified by GZhou
Some notes:
1) the mpi version is quite tricky when swapping the field.
2) the field swapping is great but not easy to understand. It is not straight forward to understand.